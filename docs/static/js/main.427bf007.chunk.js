(this["webpackJsonpaskdfjlas.github.io"]=this["webpackJsonpaskdfjlas.github.io"]||[]).push([[0],{106:function(e){e.exports=JSON.parse('{"Auth":{"region":"us-east-1","userPoolId":"us-east-1_YQGmZ3d3H","userPoolWebClientId":"7ntajq8ii4nne0s2o55cvsqlfe"}}')},145:function(e,t,n){},146:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},165:function(e,t,n){},166:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},169:function(e,t,n){},170:function(e,t,n){},171:function(e,t,n){},172:function(e,t,n){},173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},176:function(e,t,n){},177:function(e,t,n){},178:function(e,t,n){},201:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(101),o=n.n(s),i=n(70),c=n(16),u=n(14),l=n(3),d=n.n(l),p=n(4),m=n(6),h=n(7),f=n(8),v=n(10),b=n(9),g=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"setStatePromise",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){!1!==t.mounted&&t.setState(n,(function(){e()})),e()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"isEmpty",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},{key:"componentSetError",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.setError){t.next=5;break}return t.next=3,n.setError(r);case 3:t.next=7;break;case 5:return t.next=7,e.setStatePromise(n,{error:"Error: ".concat(r)});case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"componentSetSuccess",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.setSuccess){t.next=5;break}return t.next=3,n.setSuccess(r);case 3:t.next=7;break;case 5:return t.next=7,e.setStatePromise(n,{error:"",success:r});case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getImageSourceFromBase64",value:function(e,t){return"data:image/".concat(t,";base64,").concat(e)}},{key:"convertFileToBase64",value:function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){var e=r.result.split("base64,")[1];t(e)},r.onerror=function(e){return n(e)}}))}},{key:"renderMathJax",value:function(e){window.MathJax&&window.MathJax.typeset(e)}}]),e}(),k=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"checkPasswords",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===r){e.next=4;break}return e.next=3,g.componentSetError(t,"Your passwords don't match!");case 3:return e.abrupt("return",!1);case 4:if(!(n.length<6)){e.next=8;break}return e.next=7,g.componentSetError(t,"Your password is too short!");case 7:return e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),x=n(110),E=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"getProfile",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.currentAuthenticatedUser();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.signUp({username:t,password:r,attributes:{email:n}});case 2:return a=e.sent,e.abrupt("return",a.codeDeliveryDetails.Destination);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"verifyEmail",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.confirmSignUp(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"resendVerificationEmail",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.resendSignUp(t);case 2:return n=e.sent,e.abrupt("return",n.CodeDeliveryDetails.Destination);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"forgotPassword",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.forgotPassword(t);case 2:return n=e.sent,e.abrupt("return",n.CodeDeliveryDetails.Destination);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.forgotPasswordSubmit(t,n,r);case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.signIn(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.signOut();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getUsername",value:function(){var t=Object(p.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getProfile();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return t.abrupt("return",n.username);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getAccessToken",value:function(){var t=Object(p.a)(d.a.mark((function t(){var n,r,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getProfile();case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return r=n.getSignInUserSession(),a=r.getAccessToken(),t.abrupt("return",a.getJwtToken());case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),e}(),y=Object.freeze({LOGIN:0,RECOVERY_USERNAME:1,RECOVERY_PASSWORD:2,RECOVERY_SUCCESS:3,REGISTER:4,REGISTER_VERIFY:5,REGISTER_SUCCESS:6}),O=(n(145),"PreSignUp failed with error"),w=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;Object(m.a)(this,n),r=t.call(this,e);var a=e.unverifiedAccountUsername?y.REGISTER_VERIFY:y.REGISTER;return r.state={error:"",success:"",username:e.unverifiedAccountUsername,destination:e.unverifiedAccountDestination,screen:a,loading:!1},r.close=r.close.bind(Object(f.a)(r)),r.register=r.register.bind(Object(f.a)(r)),r.verifyEmail=r.verifyEmail.bind(Object(f.a)(r)),r.resendVerificationEmail=r.resendVerificationEmail.bind(Object(f.a)(r)),r.setLoading=r.setLoading.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"close",value:function(){this.props.exitCallback()}},{key:"setError",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.startsWith(O)&&(t=t.substring(O.length,t.length-1)),e.next=3,g.setStatePromise(this,{error:"Error: ".concat(t),success:""});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,s,o,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target,r=n.username.value,a=n.email.value,s=n.password.value,o=n.confirmPassword.value,r&&a&&s&&o){e.next=10;break}return e.next=9,this.setError("Please fill out all of the fields.");case 9:return e.abrupt("return");case 10:if(!(r.length<3||r.length>20)){e.next=14;break}return e.next=13,this.setError("Your username must be between ".concat(3," ")+"and ".concat(20," characters!"));case 13:return e.abrupt("return");case 14:return e.next=16,k.checkPasswords(this,s,o);case 16:if(e.sent){e.next=19;break}return e.abrupt("return");case 19:return e.next=21,this.setLoading(!0);case 21:return e.prev=21,e.next=24,E.register(r,a,s);case 24:i=e.sent,g.setStatePromise(this,{error:"",username:r,destination:i,screen:y.REGISTER_VERIFY}),e.next=32;break;case 28:return e.prev=28,e.t0=e.catch(21),e.next=32,this.setError(e.t0.message);case 32:return e.next=34,this.setLoading(!1);case 34:case"end":return e.stop()}}),e,this,[[21,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"verifyEmail",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.code.value,e.next=4,this.setLoading(!0);case 4:return e.prev=4,e.next=7,E.verifyEmail(this.state.username,n);case 7:g.setStatePromise(this,{error:"",success:"",screen:y.REGISTER_SUCCESS}),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),e.next=14,this.setError(e.t0.message);case 14:return e.next=16,this.setLoading(!1);case 16:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resendVerificationEmail",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.resendVerificationEmail(this.state.username);case 3:return e.next=5,g.componentSetSuccess(this,"Another email has been sent!");case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,this.setError(e.t0.message);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setLoading",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{loading:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e="Askd-button";this.state.loading&&(e+=" Askd-form-loading");var t,n=a.a.createElement("div",{className:"Register-form Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),a.a.createElement("h2",null,"Create an account!"),a.a.createElement("form",{className:"Askd-form",onSubmit:this.register},a.a.createElement("label",{htmlFor:"register-username"},"Username"),a.a.createElement("input",{autoComplete:"off",type:"text",name:"username",id:"register-username"}),a.a.createElement("label",{htmlFor:"register-email"},"Email"),a.a.createElement("input",{autoComplete:"off",type:"text",name:"email",id:"register-email"}),a.a.createElement("label",{htmlFor:"register-password"},"Password"),a.a.createElement("input",{autoComplete:"off",type:"password",name:"password",id:"register-password"}),a.a.createElement("label",{htmlFor:"register-confirm-password"},"Confirm password"),a.a.createElement("input",{autoComplete:"off",type:"password",name:"confirmPassword",id:"register-confirm-password"}),a.a.createElement("input",{className:e,type:"submit",value:"Register",disabled:this.state.loading}))),r=a.a.createElement("div",{className:"Register-form Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),this.state.success&&a.a.createElement("h2",null,this.state.success),a.a.createElement("h2",null,"Verify your email!"),a.a.createElement("p",null,"You should've received an email at ",this.state.destination," with a verification code. If it isn't convenient for you to verify your account now, you may do so later by logging in."),a.a.createElement("form",{className:"Askd-form",onSubmit:this.verifyEmail},a.a.createElement("label",{htmlFor:"verification-code"},"Verification code"),a.a.createElement("input",{autoComplete:"off",type:"text",name:"code",key:"verification-code",id:"verification-code"}),a.a.createElement("button",{type:"button",onClick:this.resendVerificationEmail,className:"Askd-form-link Askd-form-link-bottom"},"Didn't get the email? Click here to resend"),a.a.createElement("input",{className:e,type:"submit",value:"Submit",disabled:this.state.loading}))),s=a.a.createElement("div",{className:"Register-form Module-popup"},a.a.createElement("h2",null,"Verification success!"),a.a.createElement("p",{className:"Module-popup-last"},"Your email was successfully verified! Click the 'X' button in the top-right corner to return to the site, and you'll be able to login."));switch(this.state.screen){case y.REGISTER:t=n;break;case y.REGISTER_VERIFY:t=r;break;case y.REGISTER_SUCCESS:t=s}return a.a.createElement("div",{className:"Module-blocker"},a.a.createElement("button",{onClick:this.close,className:"Askd-form-close Askd-button Askd-button-circular"},"X"),t)}}]),n}(r.Component),C=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={error:"",username:null,destination:null,loading:!1,screen:e.screen||y.LOGIN},r.close=r.close.bind(Object(f.a)(r)),r.login=r.login.bind(Object(f.a)(r)),r.enablePasswordRecovery=r.enablePasswordRecovery.bind(Object(f.a)(r)),r.forgotPassword=r.forgotPassword.bind(Object(f.a)(r)),r.resetPassword=r.resetPassword.bind(Object(f.a)(r)),r.resendVerificationEmail=r.resendVerificationEmail.bind(Object(f.a)(r)),r.setLoading=r.setLoading.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"close",value:function(){this.props.exitCallback(!1)}},{key:"login",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target,r=n.username.value,a=n.password.value,r&&a){e.next=8;break}return e.next=7,g.componentSetError(this,"Please fill out all of the fields.");case 7:return e.abrupt("return");case 8:return e.next=10,this.setLoading(!0);case 10:return e.prev=10,e.next=13,E.login(r,a);case 13:this.props.exitCallback(!0),e.next=28;break;case 16:if(e.prev=16,e.t0=e.catch(10),"UserNotConfirmedException"!==e.t0.code){e.next=26;break}return e.next=21,E.resendVerificationEmail(r);case 21:return s=e.sent,e.next=24,this.props.emailVerificationCallback(r,s);case 24:e.next=28;break;case 26:return e.next=28,g.componentSetError(this,e.t0.message);case 28:return e.next=30,this.setLoading(!1);case 30:case"end":return e.stop()}}),e,this,[[10,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"enablePasswordRecovery",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{error:"",screen:y.RECOVERY_USERNAME});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"forgotPassword",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target.username.value){e.next=6;break}return e.next=5,g.componentsSetError(this,"Please input your username.");case 5:return e.abrupt("return");case 6:return e.next=8,this.setLoading(!0);case 8:return e.prev=8,e.next=11,E.forgotPassword(n);case 11:return r=e.sent,e.next=14,g.setStatePromise(this,{error:"",username:n,destination:r,screen:y.RECOVERY_PASSWORD});case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(8),e.next=20,g.componentSetError(this,e.t0.message);case 20:return e.next=22,this.setLoading(!1);case 22:case"end":return e.stop()}}),e,this,[[8,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target,r=n.code.value,a=n.password.value,s=n.confirmPassword.value,r&&a&&s){e.next=8;break}return g.componentSetError(this,"Please fill out all of the fields."),e.abrupt("return");case 8:return e.next=10,k.checkPasswords(this,a,s);case 10:if(e.sent){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.setLoading(!0);case 15:return e.prev=15,e.next=18,E.resetPassword(this.state.username,r,a);case 18:return e.next=20,g.setStatePromise(this,{error:"",success:"",screen:y.RECOVERY_SUCCESS});case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e.catch(15),e.next=26,g.componentSetError(this,e.t0.message);case 26:return e.next=28,this.setLoading(!1);case 28:case"end":return e.stop()}}),e,this,[[15,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resendVerificationEmail",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.forgotPassword(this.state.username);case 3:return e.next=5,g.componentSetSuccess(this,"Another email has been sent!");case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,g.componentSetError(this,e.t0.message);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setLoading",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{loading:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e="Askd-button";this.state.loading&&(e+=" Askd-form-loading");var t,n=a.a.createElement("div",{className:"Register-form Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),a.a.createElement("h2",null,"Login to your account!"),a.a.createElement("form",{className:"Askd-form",onSubmit:this.login},a.a.createElement("label",{htmlFor:"login-username"},"Username or email"),a.a.createElement("input",{autoComplete:"off",type:"text",name:"username",key:"login-username",id:"login-username"}),a.a.createElement("label",{htmlFor:"login-password"},"Password"),a.a.createElement("input",{autoComplete:"off",type:"password",name:"password",key:"login-password",id:"login-password"}),a.a.createElement("button",{type:"button",onClick:this.enablePasswordRecovery,className:"Askd-form-link Askd-form-link-bottom"},"Forgot your password?"),a.a.createElement("input",{className:e,type:"submit",value:"Login",disabled:this.state.loading}))),r=a.a.createElement("div",{className:"Register-form Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),a.a.createElement("h2",null,"Reset your password"),a.a.createElement("p",null,"Please provide your username or email, so that you can reset your password via an emailed confirmation code."),a.a.createElement("form",{className:"Askd-form",onSubmit:this.forgotPassword},a.a.createElement("label",{htmlFor:"reset-username"},"Username or email"),a.a.createElement("input",{autoComplete:"off",type:"text",name:"username",key:"reset-username",id:"reset-username"}),a.a.createElement("input",{className:e,type:"submit",value:"Submit",disabled:this.state.loading}))),s=a.a.createElement("div",{className:"Register-form Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),this.state.success&&a.a.createElement("h2",null,this.state.success),a.a.createElement("h2",null,"Reset your password"),a.a.createElement("p",null,"You should've received an email at ",this.state.destination," with a verification code."),a.a.createElement("form",{className:"Askd-form",onSubmit:this.resetPassword},a.a.createElement("label",{htmlFor:"reset-code"},"Code"),a.a.createElement("input",{autoComplete:"off",type:"text",name:"code",key:"reset-code",id:"reset-code"}),a.a.createElement("label",{htmlFor:"reset-password"},"Password"),a.a.createElement("input",{autoComplete:"off",type:"password",name:"password",key:"reset-password",id:"reset-password"}),a.a.createElement("label",{htmlFor:"reset-confirm-password"},"Confirm password"),a.a.createElement("input",{autoComplete:"off",type:"password",name:"confirmPassword",key:"reset-confirm-password",id:"reset-confirm-password"}),a.a.createElement("button",{type:"button",onClick:this.resendVerificationEmail,className:"Askd-form-link Askd-form-link-bottom"},"Didn't get the email? Click here to resend"),a.a.createElement("input",{className:e,type:"submit",value:"Submit",disabled:this.state.loading}))),o=a.a.createElement("div",{className:"Register-form Module-popup"},a.a.createElement("h2",null,"Password reset success!"),a.a.createElement("p",null,"Your password has been reset successfully. You'll now be able to login again."));switch(this.state.screen){case y.LOGIN:t=n;break;case y.RECOVERY_USERNAME:t=r;break;case y.RECOVERY_PASSWORD:t=s;break;case y.RECOVERY_SUCCESS:t=o}return a.a.createElement("div",{className:"Module-blocker"},a.a.createElement("button",{onClick:this.close,className:"Askd-form-close Askd-button Askd-button-circular"},"X"),t)}}]),n}(r.Component),I=(n(146),function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).logout=r.logout.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"logout",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.logout();case 2:return e.next=4,this.props.logoutCallback();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return a.a.createElement("div",{className:"User-menu"},a.a.createElement("ol",null,a.a.createElement("li",null,a.a.createElement(c.b,{className:"Header-menu-button",onClick:this.props.closeCallback,to:"/users/".concat(this.props.username)},"Your profile")),a.a.createElement("div",{className:"User-menu-divider"}),a.a.createElement("li",{className:"User-menu-not-link"},a.a.createElement("button",{className:"Header-menu-button"},"Settings")),a.a.createElement("li",{className:"User-menu-not-link"},a.a.createElement("button",{className:"Header-menu-button",onClick:this.logout},"Logout"))))}}]),n}(r.Component)),j=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={username:null,showRegisterForm:!1,showLoginForm:!1,showUserMenu:!1,unverifiedAccountUsername:null,unverifiedAccountDestination:null},r.refreshUsername=r.refreshUsername.bind(Object(f.a)(r)),r.toggleRegisterForm=r.toggleRegisterForm.bind(Object(f.a)(r)),r.toggleLoginForm=r.toggleLoginForm.bind(Object(f.a)(r)),r.toggleUserMenu=r.toggleUserMenu.bind(Object(f.a)(r)),r.hideUserMenu=r.hideUserMenu.bind(Object(f.a)(r)),r.afterLogin=r.afterLogin.bind(Object(f.a)(r)),r.unverifiedAccount=r.unverifiedAccount.bind(Object(f.a)(r)),window.suggestUserRegister=r.toggleRegisterForm,r}return Object(h.a)(n,[{key:"refreshUsername",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getUsername();case 2:return t=e.sent,e.next=5,g.setStatePromise(this,{username:t,showUserMenu:!1,unverifiedAccountUsername:null});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshUsername();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleRegisterForm",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.showRegisterForm){e.next=3;break}return e.next=3,g.setStatePromise(this,{unverifiedAccountUsername:null,unverifiedAccountDestination:null});case 3:return e.next=5,g.setStatePromise(this,{showRegisterForm:!this.state.showRegisterForm});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleLoginForm",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{showLoginForm:!this.state.showLoginForm});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleUserMenu",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{showUserMenu:!this.state.showUserMenu});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hideUserMenu",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.relatedTarget)||!n.classList.contains("Header-menu-button")){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,g.setStatePromise(this,{showUserMenu:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"afterLogin",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggleLoginForm();case 2:if(!t){e.next=5;break}return e.next=5,this.refreshUsername();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unverifiedAccount",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{showLoginForm:!1,showRegisterForm:!0,unverifiedAccountUsername:t,unverifiedAccountDestination:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=a.a.createElement("div",{className:"Header-top-right"},a.a.createElement("button",{className:"Header-menu-button",onClick:this.toggleLoginForm},"Login"),a.a.createElement("span",{className:"Header-divider"}),a.a.createElement("button",{className:"Header-menu-button",onClick:this.toggleRegisterForm},"Create an account")),t=a.a.createElement("div",{className:"Header-logged-in",tabIndex:"-1",onBlur:this.hideUserMenu},a.a.createElement("div",{className:"Header-top-right"},a.a.createElement("button",{className:"Header-menu-button",onClick:this.toggleUserMenu},this.state.username)),a.a.createElement("div",{className:"Header-user-menu"},this.state.showUserMenu&&a.a.createElement(I,{username:this.state.username,closeCallback:this.toggleUserMenu,logoutCallback:this.refreshUsername}))),n=this.state.username?t:e;return a.a.createElement(a.a.Fragment,null,this.state.showRegisterForm&&a.a.createElement(w,{exitCallback:this.toggleRegisterForm,unverifiedAccountUsername:this.state.unverifiedAccountUsername,unverifiedAccountDestination:this.state.unverifiedAccountDestination}),this.state.showLoginForm&&a.a.createElement(C,{exitCallback:this.afterLogin,emailVerificationCallback:this.unverifiedAccount}),n)}}]),n}(r.Component);n(151);var S=function(){var e=Object(u.g)().pathname,t="/"===e||"/home"===e,n=t?"Header":"Header-small";return a.a.createElement("div",{className:n},t&&a.a.createElement("h1",null,"cp-notes beta"),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(c.b,{to:"/home"},"Home")),a.a.createElement("li",null,a.a.createElement(c.b,{to:"/users"},"Users")),a.a.createElement("li",null,a.a.createElement(c.b,{to:"/notes"},"Notes"))),a.a.createElement(j,null),a.a.createElement("span",{className:"Header-bottom"}))},N=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){g.renderMathJax()}},{key:"render",value:function(){return a.a.createElement("div",{className:"Module-description Module-description-centered"},a.a.createElement("p",null,"A work-in-progress web application for storing publicly accessible competitive programming notes! \\[\\LaTeX\\]"))}}]),n}(r.Component);var P=function(e){var t=e.history;if(window.location.href.includes("?")){var n=window.location.href.split("?")[1].replaceAll("#","/");t.replace(n)}return a.a.createElement(a.a.Fragment,null,a.a.createElement(N,null))},A=n(11),U=Object.freeze({LOADING:0,DONE:1,NOT_FOUND:2});var T=function(e,t,n,s){return function(o){var i=Object(r.useRef)(!0),c=Object(r.useRef)(null),u=Object(r.useState)(t),l=Object(A.a)(u,2),m=l[0],h=l[1],f=Object(r.useState)(null),v=Object(A.a)(f,2),b=v[0],g=v[1],k=Object(r.useState)(U.LOADING),x=Object(A.a)(k,2),E=x[0],y=x[1],O=Object(r.useCallback)(function(){var t=Object(p.a)(d.a.mark((function t(r){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y(U.LOADING),t.prev=1,t.next=4,e(o,r);case 4:a=t.sent,i.current&&(g(a),h(r),y(U.DONE)),t.next=15;break;case 8:if(t.prev=8,t.t0=t.catch(1),t.t0.name!==n){t.next=14;break}i.current&&y(U.NOT_FOUND),t.next=15;break;case 14:throw t.t0;case 15:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),[o]);return Object(r.useEffect)((function(){return i.current=!0,JSON.stringify(c.current)!==JSON.stringify(o)&&(O(t),c.current=o),function(){i.current=!1}})),a.a.createElement(s,{otherProps:o,loadInfo:O,info:b,screen:E,currentParams:m})}};n(152);var B=function(){return a.a.createElement("div",{className:"Loading-spinner"})},L=n(51),M=n.n(L),R=Object.freeze({API_ENDPOINT:"https://qqmeusmrfk.execute-api.us-east-1.amazonaws.com/prod/"}),D=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"createApiError",value:function(e,t){var n=Error(t);return n.name=e,n}},{key:"manageResponseError",value:function(){var t=Object(p.a)(d.a.mark((function t(n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(400!==n.status){t.next=7;break}return t.next=3,n.json();case 3:throw r=t.sent,e.createApiError(r.name,r.message);case 7:if(200===n.status){t.next=9;break}throw Error("Request failed!");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"sendRequestBody",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r,a){var s,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E.getAccessToken();case 2:return s=t.sent,t.next=5,fetch(R.API_ENDPOINT+n,{method:a,body:JSON.stringify(r),headers:{Authorization:s}});case 5:return o=t.sent,t.next=8,e.manageResponseError(o);case 8:return t.next=10,o.json();case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getJson",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){var a,s,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(n,"?").concat(M.a.stringify(r)),t.next=3,E.getAccessToken();case 3:return s=t.sent,t.next=6,fetch(R.API_ENDPOINT+a,{headers:{Authorization:s}});case 6:return o=t.sent,t.next=9,e.manageResponseError(o);case 9:return t.next=11,o.json();case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"postJson",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.sendRequestBody(n,r,"POST");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"putJson",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.sendRequestBody(n,r,"PUT");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"deleteJson",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.sendRequestBody(n,r,"DELETE");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),F=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"getUserInfo",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:t},e.next=3,D.getJson("users",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUsers",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={page:t},e.next=3,D.getJson("users",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSearchUsers",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={searchTerm:t},e.next=3,D.getJson("users",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateUserInfo",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={username:t,avatarData:n,avatarExtension:r},e.next=3,D.putJson("users",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}();n(165);var V=function(e){var t=e.info,n=Object(r.useState)(!1),s=Object(A.a)(n,2),o=s[0],i=s[1],c=Object(r.useState)(g.getImageSourceFromBase64(t.avatarData,t.avatarExtension)),u=Object(A.a)(c,2),l=u[0],m=u[1],h=Object(r.useState)(""),f=Object(A.a)(h,2),v=f[0],b=f[1],k=t.contribution>0?"Users-table-contributor":"",x=function(){var e=Object(p.a)(d.a.mark((function e(n){var r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.target.files[0],e.next=3,g.convertFileToBase64(r);case 3:if(a=e.sent,"image/png"!==r.type){e.next=8;break}s="png",e.next=14;break;case 8:if("image/jpeg"!==r.type){e.next=12;break}s="jpg",e.next=14;break;case 12:return b("Error: You may only choose .png or .jpg images!"),e.abrupt("return");case 14:return e.prev=14,i(!0),b(""),e.next=19,F.updateUserInfo(t.username,a,s);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(14),b("Error: "+e.t0.message);case 24:i(!1),m(g.getImageSourceFromBase64(a,s));case 26:case"end":return e.stop()}}),e,null,[[14,21]])})));return function(t){return e.apply(this,arguments)}}(),E=a.a.createElement(a.a.Fragment,null,a.a.createElement("img",{src:l,alt:"Avatar"}),t.email&&a.a.createElement(a.a.Fragment,null,a.a.createElement("label",{htmlFor:"User-avatar-upload",tabIndex:"0"},"Change avatar"),a.a.createElement("input",{id:"User-avatar-upload",name:"avatar",type:"file",accept:"image/jpeg, image/png",onChange:x}))),y=o?a.a.createElement(B,null):E;return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",{className:"Module-heading"},t.username),a.a.createElement("div",{className:"Module-outer-space User-info"},a.a.createElement("div",{className:"User-info-info"},t.email&&a.a.createElement("p",null,"Email: ",t.email," (only visible to you)"),a.a.createElement("p",null,"Contribution:",a.a.createElement("span",{className:k},t.contribution)),a.a.createElement("p",null,"Total notes: ".concat(t.totalNotes)),a.a.createElement("p",null,"Registered: ?"),v&&a.a.createElement("p",{className:"User-info-info-error"},v)),a.a.createElement("div",{className:"User-info-avatar-outer"},a.a.createElement("div",{className:"User-info-avatar"},a.a.createElement("div",{className:"User-info-avatar-box"},y)))))},z=Object.freeze({SOLVED:{value:0,text:"Solved",css:"solved"},UPSOLVED:{value:1,text:"Upsolved",css:"upsolved"},UPSOLVED_HELP:{value:2,text:"Upsolved with help",css:"upsolved-help"},UNSOLVED:{value:3,text:"Unsolved",css:"unsolved"}}),H=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"_prettifyProblems",value:function(e){for(var t=0;t<e.length;t++)e[t].prettySk=e[t].sk.replaceAll("#","")}},{key:"getContests",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={platform:t},e.next=3,D.getJson("contests",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getProblems",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r){var a,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={platform:n,contestId:r},t.next=3,D.getJson("problems",a);case 3:return s=t.sent,e._prettifyProblems(s),t.abrupt("return",s);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getProblemInfo",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={platform:t,problemId:n},e.next=3,D.getJson("problems",r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSolvedStateText",value:function(e){for(var t in e=parseInt(e),z)if(z[t].value===e)return z[t].text}},{key:"getSolvedStateCssClass",value:function(e){for(var t in e=parseInt(e),z)if(z[t].value===e)return z[t].css}}]),e}(),J=n(13),G=(n(166),function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={loading:!1,searchTerm:"",previousValidSearchTerm:"",showOptions:!1,lastChangedTime:0,lastLoadTime:0,options:[],filteredOptions:[]},r.handleChange=r.handleChange.bind(Object(f.a)(r)),r.handleBlur=r.handleBlur.bind(Object(f.a)(r)),r.handleFocus=r.handleFocus.bind(Object(f.a)(r)),r.handleOptionSelectWithKeys=r.handleOptionSelectWithKeys.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"getOptionString",value:function(e){var t,n=[],r=Object(J.a)(this.props.keys);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(e[a])}}catch(s){r.e(s)}finally{r.f()}return n.join(" - ")}},{key:"filterOptions",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a,s,o,i,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=this.state.searchTerm.toLowerCase(),r=Object(J.a)(this.state.options),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=33;break}if(s=a.value,15!==t.length){e.next=9;break}return e.abrupt("break",33);case 9:if(!this.getOptionString(s).toLowerCase().includes(n)){e.next=13;break}return t.push(s),e.abrupt("continue",31);case 13:o=Object(J.a)(this.props.keys),e.prev=14,o.s();case 16:if((i=o.n()).done){e.next=23;break}if(c=i.value,!s[c].toLowerCase().includes(n)){e.next=21;break}return t.push(s),e.abrupt("break",23);case 21:e.next=16;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(14),o.e(e.t0);case 28:return e.prev=28,o.f(),e.finish(28);case 31:e.next=5;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(3),r.e(e.t1);case 38:return e.prev=38,r.f(),e.finish(38);case 41:return e.next=43,g.setStatePromise(this,{filteredOptions:t});case 43:case"end":return e.stop()}}),e,this,[[3,35,38,41],[14,25,28,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"networkLoadOptions",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==this.mounted){e.next=2;break}return e.abrupt("return");case 2:return t=Date.now(),e.next=5,g.setStatePromise(this,{loading:!0,lastLoadTime:t});case 5:return n=this.state.searchTerm,e.next=8,this.props.search(this.state.searchTerm);case 8:if(r=e.sent,n!==this.state.searchTerm){e.next=12;break}return e.next=12,g.setStatePromise(this,{filteredOptions:r});case 12:if(this.state.lastLoadTime!==t){e.next=15;break}return e.next=15,g.setStatePromise(this,{loading:!1});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.network||!this.props.search){e.next=35;break}if(!this.props.initialSearchSortKey){e.next=31;break}return e.next=4,g.setStatePromise(this,{searchTerm:"",loading:!0});case 4:return e.next=6,this.props.search();case 6:t=e.sent,n=Object(J.a)(t),e.prev=8,n.s();case 10:if((r=n.n()).done){e.next=19;break}if((a=r.value).sk!==this.props.initialSearchSortKey){e.next=17;break}return s=this.getOptionString(a),e.next=16,g.setStatePromise(this,{searchTerm:s,previousValidSearchTerm:s,loading:!1,options:t});case 16:return e.abrupt("break",19);case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),n.e(e.t0);case 24:return e.prev=24,n.f(),e.finish(24);case 27:return e.next=29,this.filterOptions();case 29:e.next=33;break;case 31:return e.next=33,this.componentDidUpdate({});case 33:e.next=40;break;case 35:if(!this.props.initialSearchTerm){e.next=40;break}return e.next=38,g.setStatePromise(this,{searchTerm:this.props.initialSearchTerm});case 38:return e.next=40,this.networkLoadOptions();case 40:case"end":return e.stop()}}),e,this,[[8,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.staticKey||this.props.staticKey){e.next=4;break}return e.next=3,g.setStatePromise(this,{searchTerm:""});case 3:return e.abrupt("return");case 4:if(this.props.initialSearchTerm===t.initialSearchTerm){e.next=7;break}return e.next=7,g.setStatePromise(this,{searchTerm:this.props.initialSearchTerm});case 7:if(this.props.staticKey!==t.staticKey){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,g.setStatePromise(this,{searchTerm:"",loading:!0});case 11:return e.next=13,this.props.search();case 13:return n=e.sent,e.next=16,g.setStatePromise(this,{loading:!1,previousValidSearchTerm:"",options:n,showOptions:!1});case 16:return e.next=18,this.filterOptions();case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.network){e.next=12;break}return n=Date.now(),e.next=4,g.setStatePromise(this,{searchTerm:t.target.value,lastChangedTime:n});case 4:if(!(this.state.searchTerm.length>0)){e.next=8;break}window.setTimeout((function(){r.state.lastChangedTime===n&&r.networkLoadOptions()}),250),e.next=10;break;case 8:return e.next=10,g.setStatePromise(this,{filteredOptions:[]});case 10:e.next=16;break;case 12:return e.next=14,g.setStatePromise(this,{searchTerm:t.target.value});case 14:return e.next=16,this.filterOptions();case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleBlur",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.relatedTarget)||n.id!=="Select-options-".concat(this.props.name)){e.next=3;break}return e.abrupt("return");case 3:if(!this.props.network){e.next=8;break}return e.next=6,g.setStatePromise(this,{showOptions:!1});case 6:e.next=10;break;case 8:return e.next=10,g.setStatePromise(this,{showOptions:!1,searchTerm:this.state.previousValidSearchTerm});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleFocus",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{showOptions:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleOptionSelectWithKeys",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{searchTerm:n,previousValidSearchTerm:n,showOptions:!1});case 2:return e.next=4,this.filterOptions();case 4:this.props.callback(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e,t=this,n=[],r=Object(J.a)(this.state.filteredOptions);try{var s=function(){var r=e.value;if(t.props.keys){var s=t.getOptionString(r),o=r[t.props.displayKey],i=r.sk;n.push(a.a.createElement("li",{onClick:function(){return t.handleOptionSelectWithKeys(i,o)},key:i},s))}else{var c=function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(t,{searchTerm:r,showOptions:!1});case 2:return t.props.callback(r),e.next=5,t.networkLoadOptions();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n.push(a.a.createElement("li",{onClick:c,key:r},r))}};for(r.s();!(e=r.n()).done;)s()}catch(i){r.e(i)}finally{r.f()}var o=!this.props.network&&(!this.props.search||this.state.loading);return a.a.createElement("div",{onBlur:this.handleBlur,className:"Search-select"},a.a.createElement("input",{className:this.state.loading?"Askd-form-loading":"",onChange:this.handleChange,autoComplete:"off",type:"text",value:this.state.searchTerm,onFocus:this.handleFocus,name:this.props.name,id:this.props.id,disabled:o,placeholder:this.props.placeholder}),n.length>0&&this.state.showOptions&&a.a.createElement("ol",{id:"Select-options-".concat(this.props.name),tabIndex:"-1",className:"Search-select-options"},n))}}]),n}(r.Component));var _=function(e){var t=e.initialPlatform,n=e.initialContestId,s=e.initialProblemId,o=e.initialSkipContestSearch,i=e.changeCallback,c=Object(r.useState)(t),u=Object(A.a)(c,2),l=u[0],d=u[1],p=Object(r.useState)(n),m=Object(A.a)(p,2),h=m[0],f=m[1],v=Object(r.useState)(o),b=Object(A.a)(v,2),g=b[0],k=b[1],x=null,E=null;l&&!g&&(x=function(){return H.getContests(l)},E=l);var y=null,O=null;l&&h?(y=function(){return H.getProblems(l,h)},O=l+h):l&&g&&(y=function(){return H.getProblems(l)},O=l);var w=l||"",C=g?"Want to filter by contest?":"Want to skip filtering by contest?";return Object(r.useEffect)((function(){null!==t&&d(t),null!==n&&f(n)}),[t,n]),a.a.createElement("div",{className:"Search-problem-select"},a.a.createElement("label",{htmlFor:"cp-platform"},"Platform"),a.a.createElement("select",{value:w,onChange:function(e){d(e.target.value),f(null),i(e.target.value,null,null)},name:"platform",id:"cp-platform"},a.a.createElement("option",{disabled:!0,value:""}),a.a.createElement("option",{value:"CodeForces"},"CodeForces"),a.a.createElement("option",{value:"CodeChef"},"CodeChef")),a.a.createElement("label",{htmlFor:"cp-contest"},"Contest"),a.a.createElement(G,{name:"contest",id:"cp-contest",search:x,keys:["sk","name"],callback:function(e){f(e),i(l,e,null)},displayKey:"name",staticKey:E,initialSearchSortKey:n}),a.a.createElement("button",{onClick:function(){k(!g),f(null)},type:"button",className:"Askd-form-link Askd-form-link-separator"},C),a.a.createElement("label",{htmlFor:"cp-title"},"Problem"),a.a.createElement(G,{name:"title",id:"cp-title",search:y,keys:["prettySk","name"],callback:function(e){i(l,h,e)},displayKey:"name",staticKey:O,initialSearchSortKey:s}))},Y=(n(167),function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={error:"",loading:!1},r.platform=null,r.contestId=null,r.problemId=null,r.close=r.close.bind(Object(f.a)(r)),r.problemChangeCallback=r.problemChangeCallback.bind(Object(f.a)(r)),r.addProblem=r.addProblem.bind(Object(f.a)(r)),r.setLoading=r.setLoading.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"close",value:function(){this.props.callback(null,null,null)}},{key:"problemChangeCallback",value:function(e,t,n){var r=[e,t,n];this.platform=r[0],this.contestId=r[1],this.problemId=r[2]}},{key:"addProblem",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.problemId){e.next=5;break}return e.next=4,g.componentSetError(this,"Please search and select a problem.");case 4:return e.abrupt("return");case 5:return e.next=7,this.setLoading(!0);case 7:this.props.callback(this.problemId,this.platform,this);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setLoading",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{loading:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e="Askd-button";return this.state.loading&&(e+=" Askd-form-loading"),a.a.createElement("div",{className:"Module-blocker"},a.a.createElement("button",{onClick:this.close,className:"Askd-form-close Askd-button Askd-button-circular"},"X"),a.a.createElement("div",{className:"Add-problem-form Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),a.a.createElement("h2",null,"Add a problem!"),a.a.createElement("form",{className:"Askd-form",onSubmit:this.addProblem},a.a.createElement(_,{changeCallback:this.problemChangeCallback}),a.a.createElement("input",{className:e,type:"submit",value:"Add Problem",disabled:this.state.loading}))))}}]),n}(r.Component)),W=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"getNotes",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:t},e.next=3,D.getJson("notes",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMostLikedNotes",value:function(){var t=Object(p.a)(d.a.mark((function t(n,r,a,s,o){var i,c,u,l,p,m,h,f,v,b,g,k;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=42;break}return t.next=3,e.getNotes(n);case 3:(i=t.sent).sort((function(e,t){return t.likeCount-e.likeCount})),c=[],u=Object(J.a)(i),t.prev=7,u.s();case 9:if((l=u.n()).done){t.next=22;break}if((p=l.value).published){t.next=13;break}return t.abrupt("continue",20);case 13:if(!r||p.platform===r){t.next=15;break}return t.abrupt("continue",20);case 15:if(!a||p.contestCode===a){t.next=17;break}return t.abrupt("continue",20);case 17:if(!s||p.problemSk===s){t.next=19;break}return t.abrupt("continue",20);case 19:c.push(p);case 20:t.next=9;break;case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(7),u.e(t.t0);case 27:return t.prev=27,u.f(),t.finish(27);case 30:if(m=Math.ceil(c.length/50),!(o>Math.max(m,1))){t.next=35;break}throw(h=Error()).name="PageNotFound",h;case 35:for(f=[],v=50*(o-1),b=Math.min(v+50,c.length),g=v;g<b;g++)f.push(c[g]);return t.abrupt("return",{notes:f,totalPages:Math.max(m,1)});case 42:return k={username:n,platform:r,contestId:a,problemId:s,page:o},t.next=45,D.getJson("notes",k);case 45:return t.abrupt("return",t.sent);case 46:case"end":return t.stop()}}),t,null,[[7,24,27,30]])})));return function(e,n,r,a,s){return t.apply(this,arguments)}}()},{key:"getMostRecentNotes",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={page:t,recent:!0},e.next=3,D.getJson("notes",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNoteInfo",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r,a){var s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={username:t,platform:n,problemId:r,forcePublished:a},e.next=3,D.getJson("notes",s);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"addNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={username:t,platform:n,problemId:r},e.next=3,D.postJson("notes",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"editNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r,a,s,o,i){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={username:t,platform:n,problemId:r,title:a,solved:s,content:o,published:i},e.next=3,D.putJson("notes",c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a,s,o,i){return e.apply(this,arguments)}}()},{key:"deleteNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={username:t,platform:n,problemId:r},e.next=3,D.deleteJson("notes",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),K=n(111),X=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props.info,t=H.getSolvedStateCssClass(e.solved),r=n.getNoteEditLink(e),s=n.getNotePublishedLink(e),o=e.published?"published":"unpublished",i=new Date(e.editedTime).toLocaleDateString(),u=e.username,l="/users/".concat(u),d=this.props.mostLikedMode?" - "+e.title:e.title;return a.a.createElement("li",{className:"User-note-info User-note-info-".concat(t)},a.a.createElement("ul",{className:"User-note-info-links"},this.props.loggedInUsername===u&&a.a.createElement("li",null,a.a.createElement(c.b,{className:"Askd-form-link",to:r},"Edit")),e.published&&a.a.createElement("li",null,a.a.createElement(c.b,{className:"Askd-form-link",to:s},"View"))),a.a.createElement("h5",null,e.published&&e.likeCount>0&&a.a.createElement("span",{className:"Like-dislike-score"},"+",e.likeCount),e.platform," ",e.problemCode," - ",e.problemName),a.a.createElement("h6",{className:"User-note-info-title"},this.props.mostLikedMode&&a.a.createElement(c.b,{className:"Askd-form-link",to:l},u),d),a.a.createElement("h6",{className:"User-note-info-timestamp"},i),a.a.createElement("ul",{className:"User-note-info-tags"},a.a.createElement("li",{className:"User-note-info-tag User-note-solved-indicator"}),a.a.createElement("li",{className:"User-note-info-tag User-note-tag-".concat(o)})))}}],[{key:"getNoteEditLink",value:function(e){var t=e.problemSk.replace("#","/");return"/notes/edit/".concat(e.platform,"/").concat(t)}},{key:"getNotePublishedLink",value:function(e){var t=e.problemSk.replace("#","/");return"/notes/".concat(e.username,"/").concat(e.platform,"/").concat(t)}}]),n}(r.Component),q=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){for(var e=this.props.info,t=[],n=0;n<e.notes.length;n++){var r=e.notes[n],s=r.problemSk.split("#")[1],o=r.problemSk.replace("#","/"),i=r.username,u="User-note-contest-code";s.length>=3&&(u+="-small");var l=H.getSolvedStateCssClass(r.solved);t.push(a.a.createElement("li",{key:n,className:"User-note-contest-note User-note-contest-".concat(l)},a.a.createElement("ul",{className:"User-note-contest-links"},this.props.loggedInUsername===i&&a.a.createElement("li",null,a.a.createElement(c.b,{className:"Askd-form-link",to:"/notes/edit/".concat(r.platform,"/").concat(o)},"Edit")),r.published&&a.a.createElement("li",null,a.a.createElement(c.b,{className:"Askd-form-link",to:"/notes/".concat(i,"/").concat(r.platform,"/").concat(o)},"View"))),a.a.createElement("span",{className:u},s)))}var d=new Date(e.editedTime).toLocaleDateString();return a.a.createElement("li",{className:"User-note-info"},a.a.createElement("h5",null,e.contestName),a.a.createElement("h6",{className:"User-note-contest-timestamp"},d),a.a.createElement("ul",{className:"User-note-contest-notes"},t))}}]),n}(r.Component);var Q=function(e){var t=e.title,n=e.innerContent,r=e.showing,s=e.toggleCallback,o=r?"Hide":"Show";return a.a.createElement("li",{className:"User-notes-title-dropdown"},a.a.createElement("button",{className:"User-notes-title-dropdown-showhide Askd-form-link",onClick:s},o),a.a.createElement("h4",{className:"User-notes-title-dropdown-heading"},t),r&&n)},Z=function(){function e(t,n){Object(m.a)(this,e),this.pageSize=t,this.setContent(n)}return Object(h.a)(e,[{key:"setContent",value:function(e){this.content=[],this.activeItems=e.length;for(var t=0;t<e.length;t++){var n=e[t];n.paginatorActive=!0,this.content.push(n)}}},{key:"toggleActiveItems",value:function(e){var t,n=Object(J.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=this.content[r].paginatorActive;this.content[r].paginatorActive=!a,a?this.activeItems--:this.activeItems++}}catch(s){n.e(s)}finally{n.f()}}},{key:"getContent",value:function(e){var t,n=1,r=0,a=[],s=Object(J.a)(this.content);try{for(s.s();!(t=s.n()).done;){var o=t.value;if(a.push(o),o.paginatorActive&&++r===this.pageSize){if(n===e)return a;a=[],r=0,n++}}}catch(i){s.e(i)}finally{s.f()}if(n===e)return a;throw Error("Page index out of range!")}},{key:"getPageCount",value:function(){var e,t=0,n=0,r=0,a=Object(J.a)(this.content);try{for(a.s();!(e=a.n()).done;){var s=e.value;0===n&&t++,n++,s.paginatorActive&&r++,r===this.pageSize&&(r=0,n=0)}}catch(o){a.e(o)}finally{a.f()}return t}}]),e}();n(168);var $=function(e){for(var t=e.currentPage,n=e.totalPages,r=e.callback,s=[t],o=t+1,i=2;o<n;)s.push(o),o+=i,i*=2;var c=t-1;for(i=2;c>1;)s.push(c),c-=i,i*=2;1!==t&&s.push(1),t!==n&&n>1&&s.push(n),s.sort((function(e,t){return e-t}));for(var u=[],l=function(){var e=p[d],n=e===t?"Paginator-list-selected":"Askd-form-link",s=e===t?null:function(){return r(e)};u.push(a.a.createElement("li",{key:e},a.a.createElement("button",{className:n,onClick:s},e)))},d=0,p=s;d<p.length;d++)l();return a.a.createElement("div",{className:"Paginator"},a.a.createElement("ul",{className:"Paginator-list"},u))},ee=Object.freeze({CONTEST:0,PLATFORM:1,SOLVED:2});function te(e,t){return e.editedTime>t.editedTime?-1:1}function ne(e,t){var n,r={},a=Object(J.a)(e);try{for(a.s();!(n=a.n()).done;){var s,o=n.value,i=[],c=Object(J.a)(t);try{for(c.s();!(s=c.n()).done;){var u=s.value;i.push(o[u])}}catch(d){c.e(d)}finally{c.f()}var l=i.join("#");r.hasOwnProperty(l)?r[l].push(o):r[l]=[o]}}catch(d){a.e(d)}finally{a.f()}return r}var re=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={page:1,loggedInUsername:null},r.sortNoteItems(r.props.notes),r.virtualPaginator=new Z(15,r.sortedNoteItems),r.updatePage=r.updatePage.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getUsername();case 2:return t=e.sent,e.next=5,g.setStatePromise(this,{loggedInUsername:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createContestObject",value:function(e){var t=e[0],n={contestCode:t.contestCode,contestName:t.contestName,platform:t.platform,editedTime:t.editedTime,notes:[]};this.props.organizeBySolved&&(n.solved=t.solved),this.props.organizeByPlatform&&(n.platform=t.platform);var r,a=Object(J.a)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;n.notes.push(s),s.editedTime>n.editedTime&&(n.editedTime=s.editedTime)}}catch(o){a.e(o)}finally{a.f()}return n}},{key:"sortNoteItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee.SOLVED,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=[];if(t===ee.CONTEST)if(this.props.organizeByContest){var a=ne(e,["platform","contestCode"]);for(var s in a){var o=this.createContestObject(a[s]);r.push(this.sortedNoteItems.length),this.sortedNoteItems.push(o)}}else{var i,c=Object(J.a)(e);try{for(c.s();!(i=c.n()).done;){var u=i.value;r.push(this.sortedNoteItems.length),this.sortedNoteItems.push(u)}}catch(k){c.e(k)}finally{c.f()}}else{var l,d;if(t===ee.SOLVED?(this.sortedNoteItems=[],this.dropdownShowing={},this.dropdownIndices={},this.props.sortByRecent&&(e=Object(K.a)(e).sort(te)),l=this.props.organizeBySolved,d="solved"):(l=this.props.organizeByPlatform,d="platform"),!l)return this.sortNoteItems(e,t-1,n);var p=ne(e,[d]);for(var m in p){var h="".concat(n,"#").concat(m),f=this.sortNoteItems(p[m],t-1,h);this.dropdownShowing[h]=!0,this.dropdownIndices[h]=f;var v,b=Object(J.a)(f);try{for(b.s();!(v=b.n()).done;){var g=v.value;r.push(g)}}catch(k){b.e(k)}finally{b.f()}}}return r}},{key:"renderNoteItems",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee.SOLVED,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=[];if(n===ee.CONTEST)for(var o=this.props.organizeByContest?q:X,i=0;i<e.length;i++)s.push(a.a.createElement(o,{key:i,info:e[i],loggedInUsername:this.state.loggedInUsername}));else{var c,u;if(n===ee.SOLVED?(c=this.props.organizeBySolved,u="solved"):(c=this.props.organizeByPlatform,u="platform"),!c)return this.renderNoteItems(e,n-1);var l=ne(e,[u]),m=function(e){var o="".concat(r,"#").concat(e),i=t.renderNoteItems(l[e],n-1,o),c=n===ee.SOLVED?H.getSolvedStateText(e):e,u=t.dropdownShowing[o],m=t.dropdownIndices[o],h=function(){var e=Object(p.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.virtualPaginator.toggleActiveItems(m),t.dropdownShowing[o]=!t.dropdownShowing[o],n=t.virtualPaginator.getPageCount(),!(t.state.page>n)){e.next=6;break}return e.next=6,t.updatePage(n);case 6:t.forceUpdate();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s.push(a.a.createElement(Q,{key:e,title:c,innerContent:i,showing:u,toggleCallback:h}))};for(var h in l)m(h)}return a.a.createElement("ul",{className:"User-notes-list"},s)}},{key:"updatePage",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{page:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(e,t){var n=this,r=["organizeBySolved","organizeByPlatform","organizeByContest","sortByRecent"],a=r.map((function(e){return n.props[e]})),s=r.map((function(t){return e[t]}));return JSON.stringify(a)===JSON.stringify(s)||(this.props=e,this.sortNoteItems(this.props.notes),this.virtualPaginator.setContent(this.sortedNoteItems),1===this.state.page)||(this.updatePage(1),!1)}},{key:"render",value:function(){if(0===this.props.notes.length)return a.a.createElement("p",{className:"User-notes-nothing"},"There's nothing to see here yet!");var e=this.virtualPaginator.getContent(this.state.page),t=this.virtualPaginator.getPageCount(),n=a.a.createElement($,{currentPage:this.state.page,totalPages:t,callback:this.updatePage});return a.a.createElement(a.a.Fragment,null,n,this.renderNoteItems(e),n)}}]),n}(r.Component),ae=(n(169),function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={showAddProblemForm:!1,organizeBySolved:!1,organizeByPlatform:!1,organizeByContest:!1,sortByRecent:!1},r.toggleAddProblemForm=r.toggleAddProblemForm.bind(Object(f.a)(r)),r.toggleOrganizeBySolved=r.toggleOrganizeBySolved.bind(Object(f.a)(r)),r.toggleOrganizeByPlatform=r.toggleOrganizeByPlatform.bind(Object(f.a)(r)),r.toggleOrganizeByContest=r.toggleOrganizeByContest.bind(Object(f.a)(r)),r.toggleSortByRecent=r.toggleSortByRecent.bind(Object(f.a)(r)),r.addProblem=r.addProblem.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"toggleAddProblemForm",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{showAddProblemForm:!this.state.showAddProblemForm});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleOrganizeBySolved",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{organizeBySolved:!this.state.organizeBySolved});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleOrganizeByPlatform",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{organizeByPlatform:!this.state.organizeByPlatform});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleOrganizeByContest",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{organizeByContest:!this.state.organizeByContest});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleSortByRecent",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{sortByRecent:!this.state.sortByRecent});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addProblem",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r){var a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return e.next=3,this.toggleAddProblemForm();case 3:return e.abrupt("return");case 4:return e.prev=4,a=this.props.userInfo.username,e.next=8,W.addNote(a,n,t);case 8:s=t.replace("#","/"),this.props.history.push("/notes/edit/".concat(n,"/").concat(s)),e.next=18;break;case 12:return e.prev=12,e.t0=e.catch(4),e.next=16,g.componentSetError(r,e.t0.message);case 16:return e.next=18,r.setLoading(!1);case 18:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",{className:"Module-heading"},"Notes"),this.state.showAddProblemForm&&a.a.createElement(Y,{callback:this.addProblem}),a.a.createElement("div",{className:"User-notes-outer Module-outer-space"},a.a.createElement("form",null,a.a.createElement("div",{className:"User-notes-organize"},a.a.createElement("label",null,a.a.createElement("b",null,"Organize by")),a.a.createElement("input",{type:"checkbox",name:"solved",value:"solved",onChange:this.toggleOrganizeBySolved}),a.a.createElement("label",{htmlFor:"solved"},"Solved"),a.a.createElement("input",{type:"checkbox",name:"platform",value:"platform",onChange:this.toggleOrganizeByPlatform}),a.a.createElement("label",{htmlFor:"platform"},"Platform"),a.a.createElement("input",{type:"checkbox",name:"contest",value:"contest",onChange:this.toggleOrganizeByContest}),a.a.createElement("label",{htmlFor:"contest"},"Contest")),a.a.createElement("div",{className:"User-notes-organize"},a.a.createElement("label",{htmlFor:"sort"},a.a.createElement("b",null,"Sort by")),a.a.createElement("select",{defaultValue:"default",name:"sort",onChange:this.toggleSortByRecent},a.a.createElement("option",{value:"default"},"Default"),a.a.createElement("option",{value:"recent"},"Recent")))),a.a.createElement("div",{className:"User-notes Module-space"},a.a.createElement(re,{organizeBySolved:this.state.organizeBySolved,organizeByPlatform:this.state.organizeByPlatform,organizeByContest:this.state.organizeByContest,sortByRecent:this.state.sortByRecent,notes:this.props.notes}),this.props.userInfo.email&&a.a.createElement("button",{onClick:this.toggleAddProblemForm,className:"User-notes-add Askd-button Askd-button-circular"},"+"))))}}]),n}(r.Component));function se(){return(se=Object(p.a)(d.a.mark((function e(t,n){var r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.match.params.username,e.next=3,F.getUserInfo(r);case 3:return a=e.sent,e.next=6,W.getNotes(r);case 6:return s=e.sent,a.totalNotes=s.length,a.username=r,e.abrupt("return",{userInfo:a,notes:s});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=T((function(e,t){return se.apply(this,arguments)}),null,"UserNotFound",(function(e){var t=e.otherProps,n=e.info,r=e.screen;return r===U.NOT_FOUND?a.a.createElement("div",{className:"Module-description"},a.a.createElement("h2",null,"User not found!")):r===U.LOADING?a.a.createElement(B,null):a.a.createElement(a.a.Fragment,null,a.a.createElement(V,{info:n.userInfo}),a.a.createElement(ae,{userInfo:n.userInfo,notes:n.notes,history:t.history}))})),ie=Object.freeze({MATH:1,BOLD:2,ITALIC:4,UNDERLINE:8}),ce=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"toolbarMergeBit",value:function(e,t,n){return e===ie.MATH?t?e:0:(n&ie.MATH&&(n^=ie.MATH),n^e)}},{key:"editorMergeBit",value:function(e,t,n){return e===ie.MATH?t?e:(n&e&&(n^=e),n):(n&ie.MATH&&(n=0),t?n|e:(n&e&&(n^=e),n))}},{key:"getClassName",value:function(e){var t="";for(var n in ie)e&ie[n]&&(t+="Askd-te-".concat(n," "));return t}}]),e}();var ue=function(){function e(t){Object(m.a)(this,e),this.id=t}return Object(h.a)(e,[{key:"getInfo",value:function(){var e=window.getSelection(),t=e.anchorNode.parentElement,n=e.focusNode.parentElement,r=t,a=n,s=this.getContainingMathBlock(t),o=this.getContainingMathBlock(n);s&&(t=s),o&&(n=o);var i,c,u,l,d=t.getAttribute("index"),p=n.getAttribute("index"),m=t.getAttribute("position"),h=n.getAttribute("position"),f="Askd-te-CARET"===t.getAttribute("id");if(null===d||null===p)return{rangeSelect:!1,index:0,position:0,insideCaretBlock:!1,editorSelected:!0};if(r.classList.contains("Askd-te-MATHJAX")&&0===e.anchorOffset&&(m=0),a.classList.contains("Askd-te-MATHJAX")&&0===e.focusOffset&&(h=0),null===m&&(m=e.anchorOffset),null===h&&(h=e.focusOffset),d=Number(d),m=Number(m),p=Number(p),h=Number(h),d===p&&m===h)return{rangeSelect:!1,index:d,position:m,insideCaretBlock:f,editorSelected:!0};if(c=m,l=h,!((i=d)===(u=p)?c<l:i<u)){var v=[p,d];d=v[0],p=v[1];var b=[h,m];m=b[0],h=b[1]}return{rangeSelect:!0,leftIndex:d,leftPosition:m,rightIndex:p,rightPosition:h,editorSelected:!0}}},{key:"setInfo",value:function(e,t){e.rangeSelect?(this.removeCaretBlock(),this.setRangePosition(e.leftIndex,e.leftPosition,e.rightIndex,e.rightPosition)):e.insideCaretBlock?(this.addCaretBlock(e.index,e.position,t),this.setPosition(-1,1)):(this.removeCaretBlock(),this.setPosition(e.index,e.position))}},{key:"setPosition",value:function(e,t){var n,r=(n=e>=0?document.getElementById(this.id+e):document.getElementById("Askd-te-CARET")).childNodes[0];r||(r=document.createTextNode(""),n.appendChild(r));var a=document.createRange();a.setStart(r,t),a.collapse(!0);var s=window.getSelection();s.removeAllRanges(),s.addRange(a)}},{key:"setRangePosition",value:function(e,t,n,r){var a=document.getElementById(this.id+e),s=document.getElementById(this.id+n),o=a.childNodes[0],i=s.childNodes[0],c=document.createRange();c.setStart(o,t),c.setEnd(i,r);var u=window.getSelection();u.removeAllRanges(),u.addRange(c)}},{key:"addCaretBlock",value:function(e,t,n){this.removeCaretBlock();var r=document.createElement("div");r.setAttribute("id","Askd-te-CARET"),r.setAttribute("index",e),r.setAttribute("position",t),r.setAttribute("class",ce.getClassName(n)),r.innerHTML=String.fromCharCode(8203);var a=document.getElementById(this.id+(e+1));a.parentElement.insertBefore(r,a)}},{key:"removeCaretBlock",value:function(){var e=document.getElementById("Askd-te-CARET");return!!e&&(e.parentElement.removeChild(e),!0)}},{key:"getContainingMathBlock",value:function(e){for(;e;){if(e.classList.contains("Askd-te-MATHJAX"))return e;e=e.parentElement}return null}}]),e}(),le=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=(this.props.mask&ie.BOLD)>0,n=(this.props.mask&ie.ITALIC)>0,r=(this.props.mask&ie.UNDERLINE)>0,s=(this.props.mask&ie.MATH)>0;return a.a.createElement("div",{className:"Askd-text-editor-toolbar"},a.a.createElement("ul",null,a.a.createElement("li",{className:"Askd-tb-selected-".concat(t)},a.a.createElement("button",{type:"button",className:"Askd-tb-icon Askd-tb-BOLD",onClick:function(){return e.props.callback(ie.BOLD)}})),a.a.createElement("li",{className:"Askd-tb-selected-".concat(n)},a.a.createElement("button",{type:"button",className:"Askd-tb-icon Askd-tb-ITALIC",onClick:function(){return e.props.callback(ie.ITALIC)}})),a.a.createElement("li",{className:"Askd-tb-selected-".concat(r)},a.a.createElement("button",{type:"button",className:"Askd-tb-icon Askd-tb-UNDERLINE",onClick:function(){return e.props.callback(ie.UNDERLINE)}})),a.a.createElement("li",{className:"Askd-tb-selected-".concat(s)},a.a.createElement("button",{type:"button",className:"Askd-tb-icon Askd-tb-MATH",onClick:function(){return e.props.callback(ie.MATH)}}))))}}]),n}(r.Component);function de(e){var t,n=0,r=Object(J.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;Number(a),n++}}catch(s){r.e(s)}finally{r.f()}return n}var pe=function(){function e(t){if(Object(m.a)(this,e),this.characters=[],this.caretBlockIndex=null,this.caretBlockPosition=null,t){var n,r=Object(J.a)(t);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,o=s.m,i=Object(J.a)(s.c);try{for(i.s();!(a=i.n()).done;){var c=a.value;this.characters.push({m:o,c:c})}}catch(u){i.e(u)}finally{i.f()}}}catch(u){r.e(u)}finally{r.f()}this.characters.splice(this.characters.length-1)}this.updateBlocks()}return Object(h.a)(e,[{key:"getIndexAndPosition",value:function(e){for(var t=0,n=0;n<this.blocks.length;n++){var r=de(this.blocks[n].c),a=t+r;if(e<=a)for(var s=0,o=t;o<=a;o++){if(e===o)return[n,s];s+=this.characters[o].c.length}t+=r}return[null,null]}},{key:"getGlobalIndex",value:function(e,t){for(var n=this.blockStarts[e],r=0;r<t&&n<this.characters.length;)r+=this.characters[n].c.length,n++;return r<=t?n:n-1}},{key:"getCorrectedIndexAndPosition",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===r&&(r=this.getGlobalIndex(e,t));var a=this.getIndexAndPosition(r);if(n&&r<this.characters.length){var s=this.getGlobalIndex(a[0]+1,0);if(r===s)return[a[0]+1,0]}return a}},{key:"getCharacterMask",value:function(e,t,n){var r=this.getGlobalIndex(e,t);return 0===r?this.characters.length>0?this.characters[0].m:0:n?this.characters[r].m:this.characters[r-1].m}},{key:"insert",value:function(e,t,n,r){var a,s=this.getGlobalIndex(e,t),o=this.characters.splice(s),i=Object(J.a)(n);try{for(i.s();!(a=i.n()).done;){var c=a.value;this.characters.push({m:r,c:c})}}catch(m){i.e(m)}finally{i.f()}var u,l=this.characters.length,d=Object(J.a)(o);try{for(d.s();!(u=d.n()).done;){var p=u.value;this.characters.push(p)}}catch(m){d.e(m)}finally{d.f()}return this.caretBlockIndex=null,this.caretBlockPosition=null,this.updateBlocks(),this.getIndexAndPosition(l)}},{key:"delete",value:function(e,t,n,r){var a=this.getGlobalIndex(e,t),s=this.getGlobalIndex(n,r)-a;if(a<0)return[0,0];this.characters.splice(a,s);var o=a;return this.caretBlockIndex=null,this.caretBlockPosition=null,this.updateBlocks(),this.getIndexAndPosition(o)}},{key:"rangeMaskUpdate",value:function(e,t,n,r,a,s){for(var o=this.getGlobalIndex(e,t),i=this.getGlobalIndex(n,r),c=o;c<i;c++)this.characters[c].m=ce.editorMergeBit(a,s,this.characters[c].m);this.caretBlockIndex=null,this.caretBlockPosition=null,this.updateBlocks();var u=this.getIndexAndPosition(o),l=Object(A.a)(u,2),d=l[0],p=l[1],m=this.getIndexAndPosition(i),h=Object(A.a)(m,2);return[d,p,h[0],h[1]]}},{key:"addCaretBlock",value:function(e,t){this.caretBlockIndex=e,this.caretBlockPosition=t,this.updateBlocks()}},{key:"removeCaretBlock",value:function(e){if(null!==this.caretBlockIndex)if(this.caretBlockIndex=null,this.caretBlockPosition=null,e)if(e.rangeSelect){var t=this.getGlobalIndex(e.leftIndex,e.leftPosition),n=this.getGlobalIndex(e.rightIndex,e.rightPosition);this.updateBlocks();var r=this.getCorrectedIndexAndPosition(null,null,!1,t),a=Object(A.a)(r,2);e.leftIndex=a[0],e.leftPosition=a[1];var s=this.getCorrectedIndexAndPosition(null,null,!0,n),o=Object(A.a)(s,2);e.rightIndex=o[0],e.rightPosition=o[1]}else{var i=this.getGlobalIndex(e.index,e.position);this.updateBlocks();var c=this.getCorrectedIndexAndPosition(null,null,!1,i),u=Object(A.a)(c,2);e.index=u[0],e.position=u[1]}else this.updateBlocks()}},{key:"isEmpty",value:function(){return 0===this.characters.length}},{key:"atBlockNewlineEnd",value:function(e,t){if(this.isEmpty())return!0;var n=this.blocks[e].c;return n.length===t&&n[t-1]===String.fromCharCode(10)}},{key:"updateBlocks",value:function(){var e=this;this.blocks=[],this.blockStarts=[];var t=this.characters.length>0?this.characters[0].m:0,n=[],r=0;this.characters.forEach((function(a,s){a.m===ie.MATH&&a.c===String.fromCharCode(10)&&(a.c=" ");var o=e.blocks.length===e.caretBlockIndex&&r===e.caretBlockPosition;a.m!==t||o?(0===n.length&&(t=0),e.blocks.push({m:t,c:n.join("")}),e.blockStarts.push(s-n.length),r=a.c.length,t=a.m,n=[a.c]):(n.push(a.c),r+=a.c.length)})),this.blocks.push({m:t,c:n.join("")}),this.blockStarts.push(this.characters.length-n.length),this.blocks.push({m:0,c:String.fromCharCode(10)}),this.blockStarts.push(this.characters.length)}},{key:"getContent",value:function(){return this.blocks}}]),e}();var me=function(e){var t=e.id,n=e.index,s=e.content,o=e.rendered,i=o?"\\("+s+"\\)":s,c=o?"Askd-te-MATHJAX":"Askd-te-MATH",u=o?s.length:null,l=Object(r.useMemo)((function(){return{id:t,rendered:o,blockLength:s.length}}),[t,o,s.length]);return Object(r.useEffect)((function(){if(l.rendered){g.renderMathJax(["#".concat(l.id)]);var e=document.getElementById(l.id);e.innerHTML=String.fromCharCode(8203)+e.innerHTML+String.fromCharCode(8203)}}),[l]),a.a.createElement("div",{className:c,id:t,index:n,position:u},i)},he=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props.block,t=this.props.id,n=this.props.selected,r=this.props.index,s=e.c;return e.m===ie.MATH?a.a.createElement(me,{id:t+r,rendered:!n,content:s,index:r}):a.a.createElement("div",{className:ce.getClassName(e.m),id:t+r,index:r},s)}}]),n}(r.Component);var fe=function(e){var t=e.content,n=e.id,r=e.editable,s=e.caretInfo,o=e.handleBlur,i=e.handleFocus,c=[];return t.forEach((function(e,t){var o=!1;r&&s.editorSelected&&(s.rangeSelect&&s.leftIndex<=t&&t<=s.rightIndex&&(o=!0),s.rangeSelect||s.index!==t||s.insideCaretBlock||(o=!0)),c.push(a.a.createElement(he,{block:e,id:n,index:t,key:t,selected:o}))})),a.a.createElement("div",{className:"Askd-text-editor-text",id:n,tabIndex:"0",contentEditable:r,suppressContentEditableWarning:"true",spellCheck:"false",onBlur:o,onFocus:i},c)},ve=function(e){e.textEditor.addEventListener("keydown",function(){var t=Object(p.a)(d.a.mark((function t(n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(e.state.editorMask&ie.MATH)>0,"Delete"!==n.key){t.next=5;break}n.preventDefault(),t.next=15;break;case 5:if("Backspace"!==n.key||e.composing){t.next=11;break}return t.next=8,e.delete();case 8:n.preventDefault(),t.next=15;break;case 11:if("Enter"!==n.key||e.composing||r){t.next=15;break}return t.next=14,e.insert(String.fromCharCode(10));case 14:n.preventDefault();case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.textEditor.addEventListener("beforeinput",function(){var t=Object(p.a)(d.a.mark((function t(n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.isComposing&&!e.composing){t.next=2;break}return t.abrupt("return");case 2:if(n.preventDefault(),"insertReplacementText"!==n.inputType){t.next=10;break}return e.caretInfo.rangeSelect=!0,r=n.dataTransfer.getData("text"),t.next=8,e.insert(r);case 8:t.next=13;break;case 10:if(!n.data){t.next=13;break}return t.next=13,e.insert(n.data);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.textEditor.addEventListener("paste",function(){var t=Object(p.a)(d.a.mark((function t(n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=n.clipboardData.getData("Text"),t.next=4,e.insert(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.textEditor.addEventListener("compositionstart",function(){var t=Object(p.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.caretInfo.rangeSelect){t.next=3;break}return t.next=3,e.delete();case 3:e.composing=!0,e.compositionIndex=e.caretInfo.index,e.compositionPosition=e.caretInfo.position;case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.textEditor.addEventListener("compositionend",function(){var t=Object(p.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.composing){t.next=2;break}return t.abrupt("return");case 2:return e.composing=!1,t.next=5,e.compositionInsert(n.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var t=function(t){if(!e.composing){var n=!1;try{var r=window.getSelection().anchorNode;if(e.textEditor.contains(r)){var a=e.caret.getInfo();for(var s in a)a.hasOwnProperty(s)&&e.caretInfo[s]!==a[s]&&(n=!0)}}catch(o){}n&&e.selectionChanged()}};return document.addEventListener("selectionchange",t),t},be=(n(170),function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).id=r.props.uniqueKey?"Askd-text-editor".concat(r.props.uniqueKey):"Askd-text-editor",r.virtualTextEditor=new pe(r.props.initialContent),r.caret=new ue(r.id),r.contentChanged=!1,r.caretInfo={rangeSelect:!1,index:0,position:0,editorSelected:!1,insideCaretBlock:!1},r.composing=!1,r.compositionIndex=null,r.compositionPosition=null,r.state={content:r.virtualTextEditor.getContent(),editorMask:0},r.toolbarUpdate=r.toolbarUpdate.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"delete",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.caretInfo.rangeSelect?(r=this.virtualTextEditor.delete(this.caretInfo.leftIndex,this.caretInfo.leftPosition,this.caretInfo.rightIndex,this.caretInfo.rightPosition),a=Object(A.a)(r,2),this.caretInfo.index=a[0],this.caretInfo.position=a[1]):(t=this.virtualTextEditor.delete(this.caretInfo.index,this.caretInfo.position-1,this.caretInfo.index,this.caretInfo.position),n=Object(A.a)(t,2),this.caretInfo.index=n[0],this.caretInfo.position=n[1]),this.caretInfo.rangeSelect=!1,e.next=4,this.insertionUpdate();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"insert",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.updateCaretInfo(),!this.caretInfo.rangeSelect){e.next=4;break}return e.next=4,this.delete();case 4:return n=this.virtualTextEditor.insert(this.caretInfo.index,this.caretInfo.position,t,this.state.editorMask),r=Object(A.a)(n,2),this.caretInfo.index=r[0],this.caretInfo.position=r[1],this.caretInfo.rangeSelect=!1,e.next=11,this.insertionUpdate();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"compositionInsert",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.virtualTextEditor.insert(this.compositionIndex,this.compositionPosition,t,this.state.editorMask),r=Object(A.a)(n,2),this.caretInfo.index=r[0],this.caretInfo.position=r[1],this.caretInfo.rangeSelect=!1,e.next=7,this.insertionUpdate();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rangeMaskUpdate",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.caretInfo.rangeSelect){e.next=2;break}return e.abrupt("return");case 2:return r=this.virtualTextEditor.rangeMaskUpdate(this.caretInfo.leftIndex,this.caretInfo.leftPosition,this.caretInfo.rightIndex,this.caretInfo.rightPosition,t,n),a=Object(A.a)(r,4),this.caretInfo.leftIndex=a[0],this.caretInfo.leftPosition=a[1],this.caretInfo.rightIndex=a[2],this.caretInfo.rightPosition=a[3],e.next=10,this.insertionUpdate();case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"insertionUpdate",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.contentChanged=!0,this.caret.removeCaretBlock(),this.caretInfo.insideCaretBlock=!1,e.next=5,this.updateContent();case 5:return this.caret.setInfo(this.caretInfo,this.state.editorMask),e.next=8,this.selectionChanged();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateContent",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{content:this.virtualTextEditor.getContent()});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateMask",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{editorMask:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toolbarUpdate",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.caretInfo.editorSelected=!0,n=0===(this.state.editorMask&t),r=ce.toolbarMergeBit(t,n,this.state.editorMask),this.caretInfo.rangeSelect){e.next=22;break}if(a=this.virtualTextEditor.getCharacterMask(this.caretInfo.index,this.caretInfo.position,!1),s=this.caretInfo.insideCaretBlock,this.caretInfo.insideCaretBlock=r!==a||this.virtualTextEditor.atBlockNewlineEnd(this.caretInfo.index,this.caretInfo.position),!this.caretInfo.insideCaretBlock){e.next=13;break}return this.virtualTextEditor.addCaretBlock(this.caretInfo.index,this.caretInfo.position),e.next=11,this.updateContent();case 11:e.next=17;break;case 13:if(!s){e.next=17;break}return this.virtualTextEditor.removeCaretBlock(),e.next=17,this.updateContent();case 17:return e.next=19,this.updateMask(r);case 19:this.caret.setInfo(this.caretInfo,this.state.editorMask),e.next=24;break;case 22:return e.next=24,this.rangeMaskUpdate(t,n);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"selectionChanged",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a,s,o,i,c,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.caretInfo.insideCaretBlock,this.updateCaretInfo(),!t){e.next=8;break}return this.virtualTextEditor.removeCaretBlock(this.caretInfo),this.caret.removeCaretBlock(),e.next=7,this.updateContent();case 7:this.caret.setInfo(this.caretInfo,this.state.editorMask);case 8:if(!this.caretInfo.rangeSelect){e.next=23;break}return n=!1,r=document.getElementById(this.id+this.caretInfo.leftIndex),a=document.getElementById(this.id+this.caretInfo.rightIndex),s=this.state.content[this.caretInfo.leftIndex].c.length,o=this.caretInfo.leftPosition===s,i=0===this.caretInfo.rightPosition,r.classList.contains("Askd-te-MATHJAX")&&!o&&(n=!0),a.classList.contains("Askd-te-MATHJAX")&&!i&&(n=!0),c=this.virtualTextEditor.getCharacterMask(this.caretInfo.leftIndex,this.caretInfo.leftPosition,!0),e.next=20,this.updateMask(c);case 20:n&&this.caret.setInfo(this.caretInfo,this.state.editorMask),e.next=27;break;case 23:return u=this.virtualTextEditor.getCharacterMask(this.caretInfo.index,this.caretInfo.position,!1),e.next=26,this.updateMask(u);case 26:this.caret.setInfo(this.caretInfo,this.state.editorMask);case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCaretInfo",value:function(){var e=this.caret.getInfo();if(this.caretInfo.editorSelected=!0,e.rangeSelect){var t=this.virtualTextEditor.getCorrectedIndexAndPosition(e.leftIndex,e.leftPosition,!1),n=Object(A.a)(t,2);this.caretInfo.leftIndex=n[0],this.caretInfo.leftPosition=n[1];var r=this.virtualTextEditor.getCorrectedIndexAndPosition(e.rightIndex,e.rightPosition,!0),a=Object(A.a)(r,2);this.caretInfo.rightIndex=a[0],this.caretInfo.rightPosition=a[1],this.caretInfo.rangeSelect=!0,this.caretInfo.insideCaretBlock=!1}else{var s=this.virtualTextEditor.getCorrectedIndexAndPosition(e.index,e.position,!1),o=Object(A.a)(s,2);this.caretInfo.index=o[0],this.caretInfo.position=o[1],this.virtualTextEditor.atBlockNewlineEnd(this.caretInfo.index,this.caretInfo.position)&&(e.insideCaretBlock=!0),this.caretInfo.rangeSelect=!1,this.caretInfo.insideCaretBlock=e.insideCaretBlock}}},{key:"componentDidMount",value:function(){this.textEditor=document.getElementById(this.id),this.outerTextEditor=document.getElementById(this.id+"!"),this.handleSelectionChange=ve(this)}},{key:"componentDidUpdate",value:function(){if(this.contentChanged){var e,t=[],n=Object(J.a)(this.textEditor.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeType!==Node.TEXT_NODE&&"BR"!==r.nodeName&&"SPAN"!==r.nodeName||t.push(r)}}catch(u){n.e(u)}finally{n.f()}for(var a=0,s=t;a<s.length;a++){var o=s[a];this.textEditor.removeChild(o)}for(var i=0;i<this.state.content.length;i++){var c=this.textEditor.children[i];c.classList.contains("Askd-te-MATHJAX")||c.innerHTML!==this.state.content[i].c&&(c.childNodes[0].nodeValue=this.state.content[i].c)}this.props.onChange&&this.props.onChange(this.state.content),this.contentChanged=!1}}},{key:"componentWillUnmount",value:function(){this.mounted=!1,document.removeEventListener("selectionchange",this.handleSelectionChange)}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Askd-text-editor",id:this.id+"!"},a.a.createElement(le,{mask:this.state.editorMask,callback:this.toolbarUpdate}),a.a.createElement(fe,{content:this.state.content,id:this.id,editable:!0,handleBlur:function(t){if(t.relatedTarget){var n=t.relatedTarget.classList.contains("Askd-tb-icon")&&e.outerTextEditor.contains(t.relatedTarget),r=e.textEditor.contains(t.relatedTarget);if(n||r)return}e.caretInfo.editorSelected&&(e.caretInfo.editorSelected=!1,e.caretInfo.insideCaretBlock?(e.caretInfo.insideCaretBlock=!1,e.caret.removeCaretBlock(),e.virtualTextEditor.removeCaretBlock(),e.updateContent()):e.forceUpdate())},handleFocus:this.handleSelectionChange,caretInfo:this.caretInfo}))}}]),n}(r.Component)),ge=n(229),ke=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={error:""},r.randomCode=Object(ge.a)(),r.close=r.close.bind(Object(f.a)(r)),r.deleteNote=r.deleteNote.bind(Object(f.a)(r)),r.setLoading=r.setLoading.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"close",value:function(){this.props.exitCallback()}},{key:"deleteNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.target.confirmCode.value===this.randomCode){e.next=6;break}return e.next=5,g.componentSetError(this,"Your confirmation code doesn't match!");case 5:return e.abrupt("return");case 6:return e.prev=6,e.next=9,E.getUsername();case 9:return n=e.sent,r=this.props.platform,a=this.props.problemInfo.problemId,e.next=14,this.setLoading(!0);case 14:return e.next=16,W.deleteNote(n,r,a);case 16:this.props.history.push("/users/".concat(n)),e.next=25;break;case 19:return e.prev=19,e.t0=e.catch(6),e.next=23,g.componentSetError(this,e.t0.message);case 23:return e.next=25,this.setLoading(!1);case 25:case"end":return e.stop()}}),e,this,[[6,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setLoading",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{loading:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e="Askd-button";return this.state.loading&&(e+=" Askd-form-loading"),a.a.createElement("div",{className:"Module-blocker"},a.a.createElement("button",{onClick:this.close,className:"Askd-form-close Askd-button Askd-button-circular"},"X"),a.a.createElement("div",{className:"Edit-note-delete-menu Module-popup"},this.state.error&&a.a.createElement("h2",null,this.state.error),a.a.createElement("h2",null,"Are you sure you want to permanently delete this note?"),a.a.createElement("p",null,"This action cannot be undone! Please enter the following code as confirmation."),a.a.createElement("form",{className:"Askd-form",onSubmit:this.deleteNote},a.a.createElement("label",{htmlFor:"confirmCode"},this.randomCode),a.a.createElement("input",{autoComplete:"off",type:"text",name:"confirmCode",key:"confirmCode",id:"confirmCode"}),a.a.createElement("input",{className:e,type:"submit",value:"Delete",disabled:this.state.loading}))))}}]),n}(r.Component);function xe(e){e.preventDefault(),e.returnValue=""}var Ee=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var r;Object(m.a)(this,n);var a=(r=t.call(this,e)).props.noteInfo;return r.title=a.title,r.solved=a.solved,r.content=JSON.parse(a.content),r.lastSaved=new Date(a.editedTime),r.state={published:a.published,disableEditButtons:!1,saved:!0,loadingSave:!1,loadingPublish:!1,showDeleteMenu:!1},r.saveNote=r.saveNote.bind(Object(f.a)(r)),r.togglePublishNote=r.togglePublishNote.bind(Object(f.a)(r)),r.toggleDeleteMenu=r.toggleDeleteMenu.bind(Object(f.a)(r)),r.handleTitleChange=r.handleTitleChange.bind(Object(f.a)(r)),r.handleSolvedChange=r.handleSolvedChange.bind(Object(f.a)(r)),r.handleContentChange=r.handleContentChange.bind(Object(f.a)(r)),r}return Object(h.a)(n,[{key:"saveOrPublishNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,s,o,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getUsername();case 2:return n=e.sent,r=this.props.platform,a=this.props.problemInfo.problemId,s=this.title,o=this.solved,i=JSON.stringify(this.content),e.next=10,W.editNote(n,r,a,s,o,i,t);case 10:return this.lastSaved=new Date,window.onbeforeunload=null,e.next=14,g.setStatePromise(this,{published:t,disableEditButtons:!1,saved:!0,loadingSave:!1,loadingPublish:!1});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{disableEditButtons:!0,loadingSave:!0});case 2:return e.next=4,this.saveOrPublishNote(this.state.published);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"togglePublishNote",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{disableEditButtons:!0,loadingPublish:!0});case 2:return e.next=4,this.saveOrPublishNote(!this.state.published);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleDeleteMenu",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.setStatePromise(this,{showDeleteMenu:!this.state.showDeleteMenu});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleTitleChange",value:function(e){this.title=e.target.value}},{key:"handleSolvedChange",value:function(e){this.solved=e.target.value}},{key:"handleContentChange",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.content=t,!this.state.saved){e.next=5;break}return e.next=4,g.setStatePromise(this,{saved:!1});case 4:window.onbeforeunload=xe;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this.state.saved?"All changes saved! - ":"Last saved on ";e+=this.lastSaved.toLocaleString();var t=this.state.published?"Unpublish":"Publish!",n="Askd-button Askd-not-fullwidth",r="Askd-button Askd-not-fullwidth";return this.state.loadingSave&&(n+=" Askd-form-loading"),this.state.loadingPublish&&(r+=" Askd-form-loading"),a.a.createElement(a.a.Fragment,null,a.a.createElement(u.a,{when:!this.state.saved,message:"Are you sure you want to leave? You have unsaved changes."}),this.state.showDeleteMenu&&a.a.createElement(ke,{exitCallback:this.toggleDeleteMenu,platform:this.props.platform,history:this.props.history,problemInfo:this.props.problemInfo}),a.a.createElement("form",{className:"Edit-note-form Askd-form"},a.a.createElement("input",{className:"Edit-note-title",name:"title",type:"text",defaultValue:this.title,placeholder:"Title",onChange:this.handleTitleChange}),a.a.createElement("select",{name:"solved",id:"note-solved",onChange:this.handleSolvedChange,defaultValue:this.solved},a.a.createElement("option",{value:z.SOLVED.value},"Solved"),a.a.createElement("option",{value:z.UPSOLVED.value},"Upsolved"),a.a.createElement("option",{value:z.UPSOLVED_HELP.value},"Upsolved with help"),a.a.createElement("option",{value:z.UNSOLVED.value},"Unsolved")),a.a.createElement(be,{initialContent:this.content,onChange:this.handleContentChange}),a.a.createElement("p",{className:"Edit-note-saved-text"},e),a.a.createElement("div",{className:"Edit-note-bottom-buttons"},a.a.createElement("input",{className:n,type:"button",value:"Save",onClick:this.saveNote,disabled:this.state.disableEditButtons}),a.a.createElement("input",{className:r,type:"button",value:t,onClick:this.togglePublishNote,disabled:this.state.disableEditButtons})),a.a.createElement("div",{className:"Edit-note-delete"},a.a.createElement("button",{type:"button",className:"Askd-form-link Askd-form-link-bottom",onClick:this.toggleDeleteMenu},"Permanently delete this note?"))))}}]),n}(r.Component),ye=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props.info,t=n.getProblemDisplayName(this.props.platform,e.problemCode,e.problemName);return a.a.createElement("div",{className:"Edit-note-problem-info"},a.a.createElement("div",{className:"Module-info-box"},a.a.createElement("h4",null,t),a.a.createElement("p",{className:"Edit-note-contest"},e.contestName),a.a.createElement("a",{className:"Askd-form-link",href:e.link,target:"_blank",rel:"noopener noreferrer"},"Problem link")))}}],[{key:"getProblemDisplayName",value:function(e,t,n){return"".concat(e," ").concat(t," - ").concat(n)}}]),n}(r.Component);n(171);function Oe(){return(Oe=Object(p.a)(d.a.mark((function e(t,n){var r,a,s,o,i,c,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getUsername();case 2:return r=e.sent,a=t.match.params.platform,s=t.match.params.contestId,o=t.match.params.problemCode,i="".concat(s,"#").concat(o),e.next=9,H.getProblemInfo(a,i);case 9:return(c=e.sent).problemId=i,e.next=13,W.getNoteInfo(r,a,i);case 13:return u=e.sent,e.abrupt("return",{problemInfo:c,noteInfo:u});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we=T((function(e,t){return Oe.apply(this,arguments)}),null,"NoteNotFound",(function(e){var t=e.otherProps,n=e.info,r=e.screen,s=t.match.params.platform;return r===U.NOT_FOUND?a.a.createElement("div",{className:"Module-description"},a.a.createElement("h2",null,"Note not found!")):r===U.LOADING?a.a.createElement(B,null):a.a.createElement(a.a.Fragment,null,a.a.createElement(ye,{info:n.problemInfo,platform:s}),a.a.createElement(Ee,{problemInfo:n.problemInfo,noteInfo:n.noteInfo,platform:s,history:t.history}))})),Ce=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"sendLike",value:function(){var e=Object(p.a)(d.a.mark((function e(t,n,r,a,s){var o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={username:t,noteAuthor:n,platform:r,problemId:a,likedStatus:s},e.next=3,D.putJson("likes/notes",o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a,s){return e.apply(this,arguments)}}()}]),e}();n(172);var Ie=function(e){var t=e.initialScore,n=e.initialStatus,s=e.likeCallback,o=Object(r.useState)(t),i=Object(A.a)(o,2),c=i[0],u=i[1],l=Object(r.useState)(n),m=Object(A.a)(l,2),h=m[0],f=m[1],v="Like-button";h>0&&(v+=" Like-button-liked");var b=function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getUsername();case 2:if(e.sent){e.next=6;break}return window.suggestUserRegister(),e.abrupt("return");case 6:h>0?(f(0),u(c-1),s(0)):(f(1),u(c+1),s(1));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"Like-dislike"},a.a.createElement("button",{className:v,onClick:b},a.a.createElement("span",{className:"Like-dislike-score"},"+",c)," I like this!"))};n(173);var je=function(e){var t=e.info,n=JSON.parse(t.content),r=new Date(t.editedTime).toLocaleString(),s=H.getSolvedStateCssClass(t.solved),o=function(){var e=Object(p.a)(d.a.mark((function e(n){var r,a,s,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getUsername();case 2:return r=e.sent,a=t.username,s=t.platform,o=t.problemSk,e.next=8,Ce.sendLike(r,a,s,o,n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"Public-note-info Module-space Module-padding-box"},a.a.createElement("h3",{className:"Module-space-heading"},a.a.createElement("span",{className:"Public-note-solved-tag User-note-info-".concat(s)},a.a.createElement("span",{className:"User-note-info-tag User-note-solved-indicator"})),t.title),a.a.createElement("p",{className:"Module-space-text"},"Written by ",a.a.createElement(c.b,{className:"Askd-form-link",to:"/users/".concat(t.username)},t.username)),a.a.createElement("div",{className:"Askd-text-editor"},a.a.createElement(fe,{content:n,id:"Askd-public-note",editable:!1})),a.a.createElement("p",{className:"Module-space-text"},"Last edited on ",r),a.a.createElement(Ie,{initialScore:t.likeCount,initialStatus:t.likedStatus,likeCallback:o}))};function Se(){return(Se=Object(p.a)(d.a.mark((function e(t,n){var r,a,s,o,i,c,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.match.params.ownerUsername,a=t.match.params.platform,s=t.match.params.contestId,o=t.match.params.problemCode,i="".concat(s,"#").concat(o),e.next=7,H.getProblemInfo(a,i);case 7:return(c=e.sent).problemId=i,e.next=11,W.getNoteInfo(r,a,i,!0);case 11:return u=e.sent,e.abrupt("return",{problemInfo:c,noteInfo:u});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ne=T((function(e,t){return Se.apply(this,arguments)}),null,"NoteNotFound",(function(e){var t=e.otherProps,n=e.info,r=e.screen,s=t.match.params.platform;return r===U.NOT_FOUND?a.a.createElement("div",{className:"Module-description"},a.a.createElement("h2",null,"Note is either unpublished or does not exist!")):r===U.LOADING?a.a.createElement(B,null):a.a.createElement(a.a.Fragment,null,a.a.createElement(ye,{info:n.problemInfo,platform:s}),a.a.createElement(je,{info:n.noteInfo}))}));var Pe=function(e){var t=e.callback,n=e.initialUsername,r=e.attachLabel,s=r?null:"Search by username";return a.a.createElement("div",{className:"Askd-form Users-table-search"},r&&a.a.createElement("label",{htmlFor:"username"},"Username"),a.a.createElement(G,{name:"username",id:"cp-username-search",search:F.getSearchUsers,staticKey:"username",network:!0,placeholder:s,initialSearchTerm:n,callback:t}))};n(174);var Ae=function(e){var t,n=e.currentPage,r=e.lastUpdated,s=e.users,o=new Date(r).toLocaleString(),i=[],u=50*(n-1)+1,l=Object(J.a)(s);try{for(l.s();!(t=l.n()).done;){var d=t.value,p=d.contribution>0?"Users-table-contributor":"";i.push(a.a.createElement("tr",{key:u},a.a.createElement("td",null,u),a.a.createElement("td",{className:"Users-table-username"},a.a.createElement(c.b,{className:"Askd-button Askd-button-generic",to:"/users/".concat(d.username)},d.username)),a.a.createElement("td",{className:p},d.contribution))),u++}}catch(m){l.e(m)}finally{l.f()}return a.a.createElement("div",{className:"Users-table"},a.a.createElement("div",{className:"Users-table-table"},a.a.createElement("div",{className:"Users-table-table-table"},a.a.createElement("table",null,a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",null,"#"),a.a.createElement("th",{className:"Users-table-username"},"Username"),a.a.createElement("th",null,"Contribution")),i)))),a.a.createElement("span",{className:"Users-table-last-updated"},"Last updated on ",o))};function Ue(){return(Ue=Object(p.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.getUsers(n);case 2:return r=e.sent,e.abrupt("return",{usersInfo:r});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te=T((function(e,t){return Ue.apply(this,arguments)}),1,"PageNotFound",(function(e){var t=e.otherProps,n=e.info,r=e.loadInfo,s=e.screen,o=e.currentParams,i=function(e){t.history.push("/users/".concat(e))},c=n?n.usersInfo:null;if(s===U.NOT_FOUND)return a.a.createElement("div",{className:"Module-description"},"Page not found!");if(s===U.LOADING)return a.a.createElement(a.a.Fragment,null,a.a.createElement(Pe,{callback:i}),a.a.createElement("div",{className:"Module-space"},a.a.createElement(B,null)));var u=a.a.createElement($,{currentPage:o,totalPages:c.totalPages,callback:r});return a.a.createElement(a.a.Fragment,null,a.a.createElement(Pe,{callback:i}),a.a.createElement("div",{className:"Module-space"},u,a.a.createElement(Ae,{currentPage:o,users:c.users,lastUpdated:c.lastUpdated}),u))})),Be=n(75);function Le(){return(Le=Object(p.a)(d.a.mark((function e(t,n){var r,a,s,o,i,c,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,a=t.platform,s=t.contestId,o=t.problemId,i=t.page,e.next=7,W.getMostLikedNotes(r,a,s,o,i);case 7:return c=e.sent,e.next=10,E.getUsername();case 10:return u=e.sent,e.abrupt("return",Object(Be.a)(Object(Be.a)({},c),{},{loggedInUsername:u}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Me=T((function(e,t){return Le.apply(this,arguments)}),null,"PageNotFound",(function(e){var t,n=e.otherProps,r=e.info,s=e.screen;if(s===U.NOT_FOUND)t=a.a.createElement("p",{className:"User-notes-nothing"},"Page not found!");else if(s===U.LOADING)t=a.a.createElement(B,null);else{for(var o=a.a.createElement($,{currentPage:n.page,totalPages:r.totalPages,callback:n.pageChangeCallback}),i=[],c=0;c<r.notes.length;c++)i.push(a.a.createElement(X,{key:c,info:r.notes[c],mostLikedMode:!0,loggedInUsername:r.loggedInUsername}));t=0===i.length?a.a.createElement("p",{className:"User-notes-nothing"},"There are no published notes for that search!"):a.a.createElement(a.a.Fragment,null,o,a.a.createElement("ul",{className:"User-notes-list"},i),o)}return a.a.createElement("div",{className:"User-notes Module-space"},t)}));n(175);var Re=function(e){var t=e.history,n=M.a.parse(window.location.search),s=Number(n.page)||1;s>0||(s=1);var o=n.username||"",i=n.platform||"",c=n.contestId||"",u=n.problemId||"",l=function(e){for(var r in e)null===e[r]?delete n[r]:n[r]=e[r];var a=M.a.stringify(n);t.push("/notes?".concat(a))},d=Object(r.useState)(!1),p=Object(A.a)(d,2),m=p[0],h=p[1],f=m?"Want to hide this?":"Want to filter by username, platform, contest, or problem?",v=!!u&&!c;return a.a.createElement("div",{className:"Notes-search"},a.a.createElement("button",{onClick:function(){h(!m)},className:"Askd-form-link"},f),m&&a.a.createElement("div",{className:"Module-outer-space"},a.a.createElement("form",{className:"Askd-form"},a.a.createElement(Pe,{callback:function(e){l({username:e,page:1})},initialUsername:o,attachLabel:!0}),a.a.createElement(_,{initialPlatform:i,initialContestId:c,initialProblemId:u,initialSkipContestSearch:v,changeCallback:function(e,t,n){l({platform:e,contestId:t,problemId:n,page:1})}}),a.a.createElement("button",{onClick:function(e){e.preventDefault(),l({page:1,username:null,platform:null,contestId:null,problemId:null})},className:"Askd-form-link Notes-search-reset"},"Reset all filters"))),a.a.createElement(Me,{username:o,platform:i,contestId:c,problemId:u,page:s,pageChangeCallback:function(e){l({page:e})}}))};function De(){return(De=Object(p.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.getMostRecentNotes(1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(e,t,n,r){if("CodeForces"===e)return"".concat(t," ").concat(n," - ").concat(r)}var Ve=T((function(e,t){return De.apply(this,arguments)}),null,null,(function(e){e.otherProps;var t,n=e.loadInfo,s=e.info,o=e.screen,i=Object(u.g)();if(Object(r.useEffect)((function(){n()}),[n,i]),o===U.LOADING)t=a.a.createElement(B,null);else if(o===U.DONE){t=[];for(var l=0;l<s.notes.length;l++){var d=s.notes[l],p=X.getNotePublishedLink(d),m=Fe(d.platform,d.contestName,d.problemCode,d.problemName);t.push(a.a.createElement("li",{key:l},a.a.createElement(c.b,{className:"Askd-form-link",to:"/users/".concat(d.username)},d.username)," - ",a.a.createElement(c.b,{className:"Askd-button Askd-button-generic",to:p},m)))}t=a.a.createElement("ol",{className:"Module-recent-notes-list"},t)}return a.a.createElement("div",{className:"Module-recent-notes"},a.a.createElement("h4",{className:"Module-heading"},"Recent actions"),t)}));n(176),n(177),n(178);var ze=function(){return a.a.createElement(c.a,null,a.a.createElement("div",{className:"App"},a.a.createElement(S,null),a.a.createElement("div",{className:"Module-wrapper"},a.a.createElement("div",{className:"Module-content-left"},a.a.createElement(u.d,null,a.a.createElement(u.b,{exact:!0,path:"/",component:P}),a.a.createElement(u.b,{exact:!0,path:"/home",component:P}),a.a.createElement(u.b,{exact:!0,path:"/users",component:Te}),a.a.createElement(u.b,{exact:!0,path:"/notes",component:Re}),a.a.createElement(u.b,{exact:!0,path:"/users/:username",component:oe}),a.a.createElement(u.b,{exact:!0,path:"/notes/edit/:platform/:contestId/:problemCode",component:we}),a.a.createElement(u.b,{exact:!0,path:"/notes/:ownerUsername/:platform/:contestId/:problemCode",component:Ne}))),a.a.createElement(Ve,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var He=n(106);i.default.configure(He),document.body.addEventListener("mousedown",(function(e){document.body.classList.add("Global-mouse-click")})),document.body.addEventListener("keydown",(function(e){9===e.keyCode&&document.body.classList.remove("Global-mouse-click")})),o.a.render(a.a.createElement(ze,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[201,1,2]]]);
//# sourceMappingURL=main.427bf007.chunk.js.map